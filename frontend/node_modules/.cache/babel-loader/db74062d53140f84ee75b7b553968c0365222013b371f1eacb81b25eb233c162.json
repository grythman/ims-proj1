{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Card,CardContent,CardHeader,CardTitle}from'../UI/Card';import{Button}from'../UI/Button';import{MessageSquare,User,Send,Clock,AlertCircle}from'lucide-react';import{toast}from'react-hot-toast';import mentorApi from'../../services/mentorApi';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AdviceThread=_ref=>{let{student,onSendAdvice}=_ref;const[message,setMessage]=useState('');const[sending,setSending]=useState(false);const handleSubmit=async e=>{e.preventDefault();if(!message.trim())return;setSending(true);try{await onSendAdvice(student.id,message);setMessage('');}finally{setSending(false);}};return/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(CardContent,{className:\"p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center\",children:student.profile_picture?/*#__PURE__*/_jsx(\"img\",{src:student.profile_picture,alt:student.name,className:\"h-10 w-10 rounded-full object-cover\"}):/*#__PURE__*/_jsx(User,{className:\"h-6 w-6 text-blue-600\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium text-gray-900\",children:student.name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:student.internship_position})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3 max-h-60 overflow-y-auto\",children:student.advice_history.map((advice,index)=>/*#__PURE__*/_jsxs(\"div\",{className:`p-3 rounded-lg ${advice.from_mentor?'bg-blue-50 ml-8':'bg-gray-50 mr-8'}`,children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm\",children:advice.message}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-gray-500 mt-1 block\",children:new Date(advice.timestamp).toLocaleString()})]},index))}),/*#__PURE__*/_jsx(\"form\",{onSubmit:handleSubmit,className:\"mt-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[/*#__PURE__*/_jsx(\"textarea\",{value:message,onChange:e=>setMessage(e.target.value),placeholder:\"Type your advice here...\",className:\"flex-1 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\",rows:2}),/*#__PURE__*/_jsx(Button,{type:\"submit\",disabled:sending||!message.trim(),loading:sending,children:/*#__PURE__*/_jsx(Send,{className:\"h-4 w-4\"})})]})})]})})});};const StudentAdvice=()=>{const[students,setStudents]=useState([]);const[loading,setLoading]=useState(true);const[selectedStudent,setSelectedStudent]=useState(null);useEffect(()=>{fetchStudents();},[]);const fetchStudents=async()=>{try{const data=await mentorApi.students.getAllAssigned();setStudents(data);}catch(error){toast.error('Failed to load students');}finally{setLoading(false);}};const handleSendAdvice=async(studentId,message)=>{try{await mentorApi.students.sendAdvice(studentId,{message});toast.success('Advice sent successfully');// Refresh the student data\nconst updatedStudents=await mentorApi.students.getAllAssigned();setStudents(updatedStudents);}catch(error){toast.error('Failed to send advice');throw error;// Re-throw to handle in the component\n}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center min-h-[400px]\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-gray-900\",children:\"Student Advice\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-gray-500\",children:[students.length,\" assigned students\"]})]}),students.length===0?/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{className:\"p-6 text-center\",children:[/*#__PURE__*/_jsx(AlertCircle,{className:\"h-12 w-12 text-gray-400 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900\",children:\"No assigned students\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 mt-1\",children:\"You currently have no students assigned to mentor\"})]})}):/*#__PURE__*/_jsx(\"div\",{className:\"grid gap-6 md:grid-cols-2\",children:students.map(student=>/*#__PURE__*/_jsx(AdviceThread,{student:student,onSendAdvice:handleSendAdvice},student.id))})]});};export default StudentAdvice;","map":{"version":3,"names":["React","useState","useEffect","Card","CardContent","CardHeader","CardTitle","Button","MessageSquare","User","Send","Clock","AlertCircle","toast","mentorApi","jsx","_jsx","jsxs","_jsxs","AdviceThread","_ref","student","onSendAdvice","message","setMessage","sending","setSending","handleSubmit","e","preventDefault","trim","id","children","className","profile_picture","src","alt","name","internship_position","advice_history","map","advice","index","from_mentor","Date","timestamp","toLocaleString","onSubmit","value","onChange","target","placeholder","rows","type","disabled","loading","StudentAdvice","students","setStudents","setLoading","selectedStudent","setSelectedStudent","fetchStudents","data","getAllAssigned","error","handleSendAdvice","studentId","sendAdvice","success","updatedStudents","length"],"sources":["C:/Users/Admin/ims-proj/frontend/src/components/mentor/StudentAdvice.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '../UI/Card';\nimport { Button } from '../UI/Button';\nimport { \n  MessageSquare, \n  User, \n  Send, \n  Clock,\n  AlertCircle\n} from 'lucide-react';\nimport { toast } from 'react-hot-toast';\nimport mentorApi from '../../services/mentorApi';\n\nconst AdviceThread = ({ student, onSendAdvice }) => {\n  const [message, setMessage] = useState('');\n  const [sending, setSending] = useState(false);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    if (!message.trim()) return;\n\n    setSending(true);\n    try {\n      await onSendAdvice(student.id, message);\n      setMessage('');\n    } finally {\n      setSending(false);\n    }\n  };\n\n  return (\n    <Card>\n      <CardContent className=\"p-6\">\n        <div className=\"space-y-4\">\n          {/* Student Info */}\n          <div className=\"flex items-center space-x-3\">\n            <div className=\"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center\">\n              {student.profile_picture ? (\n                <img\n                  src={student.profile_picture}\n                  alt={student.name}\n                  className=\"h-10 w-10 rounded-full object-cover\"\n                />\n              ) : (\n                <User className=\"h-6 w-6 text-blue-600\" />\n              )}\n            </div>\n            <div>\n              <h3 className=\"font-medium text-gray-900\">{student.name}</h3>\n              <p className=\"text-sm text-gray-500\">{student.internship_position}</p>\n            </div>\n          </div>\n\n          {/* Previous Messages */}\n          <div className=\"space-y-3 max-h-60 overflow-y-auto\">\n            {student.advice_history.map((advice, index) => (\n              <div\n                key={index}\n                className={`p-3 rounded-lg ${\n                  advice.from_mentor\n                    ? 'bg-blue-50 ml-8'\n                    : 'bg-gray-50 mr-8'\n                }`}\n              >\n                <p className=\"text-sm\">{advice.message}</p>\n                <span className=\"text-xs text-gray-500 mt-1 block\">\n                  {new Date(advice.timestamp).toLocaleString()}\n                </span>\n              </div>\n            ))}\n          </div>\n\n          {/* New Message Form */}\n          <form onSubmit={handleSubmit} className=\"mt-4\">\n            <div className=\"flex space-x-2\">\n              <textarea\n                value={message}\n                onChange={(e) => setMessage(e.target.value)}\n                placeholder=\"Type your advice here...\"\n                className=\"flex-1 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\"\n                rows={2}\n              />\n              <Button\n                type=\"submit\"\n                disabled={sending || !message.trim()}\n                loading={sending}\n              >\n                <Send className=\"h-4 w-4\" />\n              </Button>\n            </div>\n          </form>\n        </div>\n      </CardContent>\n    </Card>\n  );\n};\n\nconst StudentAdvice = () => {\n  const [students, setStudents] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [selectedStudent, setSelectedStudent] = useState(null);\n\n  useEffect(() => {\n    fetchStudents();\n  }, []);\n\n  const fetchStudents = async () => {\n    try {\n      const data = await mentorApi.students.getAllAssigned();\n      setStudents(data);\n    } catch (error) {\n      toast.error('Failed to load students');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSendAdvice = async (studentId, message) => {\n    try {\n      await mentorApi.students.sendAdvice(studentId, { message });\n      toast.success('Advice sent successfully');\n      // Refresh the student data\n      const updatedStudents = await mentorApi.students.getAllAssigned();\n      setStudents(updatedStudents);\n    } catch (error) {\n      toast.error('Failed to send advice');\n      throw error; // Re-throw to handle in the component\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-[400px]\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex justify-between items-center\">\n        <h2 className=\"text-lg font-semibold text-gray-900\">Student Advice</h2>\n        <span className=\"text-sm text-gray-500\">\n          {students.length} assigned students\n        </span>\n      </div>\n\n      {students.length === 0 ? (\n        <Card>\n          <CardContent className=\"p-6 text-center\">\n            <AlertCircle className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n            <h3 className=\"text-lg font-medium text-gray-900\">No assigned students</h3>\n            <p className=\"text-gray-500 mt-1\">\n              You currently have no students assigned to mentor\n            </p>\n          </CardContent>\n        </Card>\n      ) : (\n        <div className=\"grid gap-6 md:grid-cols-2\">\n          {students.map((student) => (\n            <AdviceThread\n              key={student.id}\n              student={student}\n              onSendAdvice={handleSendAdvice}\n            />\n          ))}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default StudentAdvice; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}