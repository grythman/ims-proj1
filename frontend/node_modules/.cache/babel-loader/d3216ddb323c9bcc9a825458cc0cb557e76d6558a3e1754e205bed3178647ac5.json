{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{toast}from'react-hot-toast';import{UserCog}from'lucide-react';import{Button}from'../UI/Button';import{Card,CardHeader,CardContent,CardTitle,CardDescription}from'../UI/Card';import studentApi from'../../services/studentApi';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const EditProfile=()=>{const[profile,setProfile]=useState(null);const[loading,setLoading]=useState(true);const[saving,setSaving]=useState(false);const[error,setError]=useState(null);const navigate=useNavigate();useEffect(()=>{const fetchProfile=async()=>{try{const data=await studentApi.profile.getProfile();setProfile(data);}catch(err){setError('Failed to load profile');toast.error('Failed to load profile');}finally{setLoading(false);}};fetchProfile();},[]);const validateProfile=data=>{var _data$firstName,_data$lastName,_data$email;const errors={};if(!((_data$firstName=data.firstName)!==null&&_data$firstName!==void 0&&_data$firstName.trim()))errors.firstName='First name is required';if(!((_data$lastName=data.lastName)!==null&&_data$lastName!==void 0&&_data$lastName.trim()))errors.lastName='Last name is required';if(!((_data$email=data.email)!==null&&_data$email!==void 0&&_data$email.trim()))errors.email='Email is required';if(data.email&&!/\\S+@\\S+\\.\\S+/.test(data.email))errors.email='Invalid email format';return errors;};const handleSubmit=async e=>{e.preventDefault();setSaving(true);setError(null);const validationErrors=validateProfile(profile);if(Object.keys(validationErrors).length>0){setError(Object.values(validationErrors).join(', '));setSaving(false);return;}try{await studentApi.profile.updateProfile(profile);toast.success('Profile updated successfully');navigate('/dashboard');}catch(err){setError('Failed to update profile');toast.error('Failed to update profile');}finally{setSaving(false);}};const handleImageUpload=async e=>{const file=e.target.files[0];if(!file)return;const formData=new FormData();formData.append('image',file);try{await studentApi.profile.uploadProfilePicture(formData);toast.success('Profile picture updated');}catch(err){toast.error('Failed to upload profile picture');}};if(loading){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading profile...\"});}return/*#__PURE__*/_jsxs(Card,{className:\"max-w-2xl mx-auto\",children:[/*#__PURE__*/_jsxs(CardHeader,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"rounded-lg bg-emerald-500/10 p-2 w-fit\",children:/*#__PURE__*/_jsx(UserCog,{className:\"h-6 w-6 text-emerald-500\"})}),/*#__PURE__*/_jsx(CardTitle,{children:\"Edit Profile\"}),/*#__PURE__*/_jsx(CardDescription,{children:\"Update your personal information\"})]}),/*#__PURE__*/_jsx(CardContent,{children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 gap-4\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"Profile Picture\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-1 flex items-center space-x-4\",children:[/*#__PURE__*/_jsx(Button,{type:\"button\",variant:\"outline\",onClick:()=>document.getElementById('profile-picture').click(),children:\"Choose File\"}),/*#__PURE__*/_jsx(\"input\",{id:\"profile-picture\",type:\"file\",accept:\"image/*\",onChange:handleImageUpload,className:\"hidden\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-500\",children:profile!==null&&profile!==void 0&&profile.profilePicture?'Change picture':'Upload a profile picture'})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-4 pt-4\",children:[/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"primary\",className:\"flex-1 bg-emerald-600 hover:bg-emerald-700\",disabled:saving,loading:saving,children:saving?'Saving Changes...':'Save Changes'}),/*#__PURE__*/_jsx(Button,{type:\"button\",variant:\"outline\",className:\"flex-1\",onClick:()=>navigate('/dashboard'),children:\"Cancel\"})]}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-sm mt-2\",children:error})]})})]});};export default EditProfile;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","toast","UserCog","Button","Card","CardHeader","CardContent","CardTitle","CardDescription","studentApi","jsx","_jsx","jsxs","_jsxs","EditProfile","profile","setProfile","loading","setLoading","saving","setSaving","error","setError","navigate","fetchProfile","data","getProfile","err","validateProfile","_data$firstName","_data$lastName","_data$email","errors","firstName","trim","lastName","email","test","handleSubmit","e","preventDefault","validationErrors","Object","keys","length","values","join","updateProfile","success","handleImageUpload","file","target","files","formData","FormData","append","uploadProfilePicture","children","className","onSubmit","type","variant","onClick","document","getElementById","click","id","accept","onChange","profilePicture","disabled"],"sources":["C:/Users/Admin/ims-proj/frontend/src/components/student/EditProfile.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { toast } from 'react-hot-toast';\nimport { UserCog } from 'lucide-react';\nimport { Button } from '../UI/Button';\nimport { Card, CardHeader, CardContent, CardTitle, CardDescription } from '../UI/Card';\nimport studentApi from '../../services/studentApi';\n\nconst EditProfile = () => {\n  const [profile, setProfile] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [error, setError] = useState(null);\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const fetchProfile = async () => {\n      try {\n        const data = await studentApi.profile.getProfile();\n        setProfile(data);\n      } catch (err) {\n        setError('Failed to load profile');\n        toast.error('Failed to load profile');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchProfile();\n  }, []);\n\n  const validateProfile = (data) => {\n    const errors = {};\n    if (!data.firstName?.trim()) errors.firstName = 'First name is required';\n    if (!data.lastName?.trim()) errors.lastName = 'Last name is required';\n    if (!data.email?.trim()) errors.email = 'Email is required';\n    if (data.email && !/\\S+@\\S+\\.\\S+/.test(data.email)) errors.email = 'Invalid email format';\n    return errors;\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setSaving(true);\n    setError(null);\n\n    const validationErrors = validateProfile(profile);\n    if (Object.keys(validationErrors).length > 0) {\n      setError(Object.values(validationErrors).join(', '));\n      setSaving(false);\n      return;\n    }\n\n    try {\n      await studentApi.profile.updateProfile(profile);\n      toast.success('Profile updated successfully');\n      navigate('/dashboard');\n    } catch (err) {\n      setError('Failed to update profile');\n      toast.error('Failed to update profile');\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleImageUpload = async (e) => {\n    const file = e.target.files[0];\n    if (!file) return;\n\n    const formData = new FormData();\n    formData.append('image', file);\n\n    try {\n      await studentApi.profile.uploadProfilePicture(formData);\n      toast.success('Profile picture updated');\n    } catch (err) {\n      toast.error('Failed to upload profile picture');\n    }\n  };\n\n  if (loading) {\n    return <div>Loading profile...</div>;\n  }\n\n  return (\n    <Card className=\"max-w-2xl mx-auto\">\n      <CardHeader>\n        <div className=\"rounded-lg bg-emerald-500/10 p-2 w-fit\">\n          <UserCog className=\"h-6 w-6 text-emerald-500\" />\n        </div>\n        <CardTitle>Edit Profile</CardTitle>\n        <CardDescription>Update your personal information</CardDescription>\n      </CardHeader>\n      <CardContent>\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          {/* Form fields */}\n          <div className=\"grid grid-cols-2 gap-4\">\n            {/* Add your form fields here */}\n          </div>\n          \n          {/* Profile Picture Upload */}\n          <div className=\"mt-4\">\n            <label className=\"block text-sm font-medium text-gray-700\">\n              Profile Picture\n            </label>\n            <div className=\"mt-1 flex items-center space-x-4\">\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={() => document.getElementById('profile-picture').click()}\n              >\n                Choose File\n              </Button>\n              <input\n                id=\"profile-picture\"\n                type=\"file\"\n                accept=\"image/*\"\n                onChange={handleImageUpload}\n                className=\"hidden\"\n              />\n              <span className=\"text-sm text-gray-500\">\n                {profile?.profilePicture ? 'Change picture' : 'Upload a profile picture'}\n              </span>\n            </div>\n          </div>\n\n          <div className=\"flex space-x-4 pt-4\">\n            <Button\n              type=\"submit\"\n              variant=\"primary\"\n              className=\"flex-1 bg-emerald-600 hover:bg-emerald-700\"\n              disabled={saving}\n              loading={saving}\n            >\n              {saving ? 'Saving Changes...' : 'Save Changes'}\n            </Button>\n            \n            <Button\n              type=\"button\"\n              variant=\"outline\"\n              className=\"flex-1\"\n              onClick={() => navigate('/dashboard')}\n            >\n              Cancel\n            </Button>\n          </div>\n\n          {error && (\n            <p className=\"text-red-500 text-sm mt-2\">{error}</p>\n          )}\n        </form>\n      </CardContent>\n    </Card>\n  );\n};\n\nexport default EditProfile;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}